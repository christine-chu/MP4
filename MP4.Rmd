---
title: "MP4"
author: "Christine Chu"
date: "April 25, 2018"
output: html_document
--- 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("mdsr")
install.packages("RMySQL")
library(mdsr)
library(RMySQL)
```

Database for Querying 
#replace quotation with dataset we choose
```{r}
db <- dbConnect_scidb(dbname = "lahman")
```


# Individual chunks to prevent overwriting of code.
Christine 
```{r}
# This search query returns us the salaries of the players, team affilation, and the year that they received the salary and orders it from highest to lowest. 

#do you guys think this would be helpful? 
db %>% 
  dbGetQuery("SELECT ls.yearID, ls.teamID, lt.franchID, ls.playerID, ls.salary, tf.franchName
FROM lahman.Salaries ls 
JOIN lahman.Teams lt ON lt.teamID = ls.teamID
JOIN TeamsFranchises tf ON lt.franchID = tf.franchID
ORDER BY salary desc
;")
```

```{r}

# including Hall of Fame status on the salary table, with the names of the teams. 
db2 <- dbConnect_scidb(dbname = "lahman")
db2 %>% 
  dbGetQuery("SELECT ls.yearID, ls.playerID, ls.salary, tf.franchName AS 'Team_name', hf.inducted
FROM lahman.Salaries ls 
JOIN lahman.HallOfFame hf ON hf.playerID = ls.playerID
JOIN lahman.Teams lt ON lt.teamID = ls.teamID
JOIN lahman.TeamsFranchises tf ON tf.franchID = lt.franchID
WHERE hf.inducted = 'Y'
#group by 
ORDER BY ls.salary desc
;
")
```

```{r}

#not inducted into the hall of fame 
db2 %>% 
  dbGetQuery("SELECT ls.yearID, ls.playerID, ls.salary, tf.franchName AS 'Team_name', hf.inducted
FROM lahman.Salaries ls 
JOIN lahman.HallOfFame hf ON hf.playerID = ls.playerID
JOIN lahman.Teams lt ON lt.teamID = ls.teamID
JOIN lahman.TeamsFranchises tf ON tf.franchID = lt.franchID
WHERE hf.inducted = 'N'
GROUP BY playerID  
ORDER BY ls.salary desc
;")
#how come when i group it by player ID, some rows disappear??
```

Nybria 
```{r}
db <- dbConnect_scidb(dbname = "imdb")
db %>%
  dbGetQuery("SELECT * FROM kind_type;")

# we cannot access this data base
cb <- dbConnect_scidb(dbname = "citibike")
# we cannot access this data base
ntaxi <- dbConnect_scidb(dbname = "nyctaxi")

```

```{r}
#I am trying to combine two tables the Hall of Fame and Salary, I am trying things out, so I have been having trouble 

dbGetQuery("SELECT hf.playerID, hf.inducted, s.playerID, s.salary
FROM lahman.HallOfFame hf
JOIN lahman.Salaries s ON hf.playerID = s.playerID
ORDER BY s.salary desc;")


# combining tables 

dbGetQuery("SELECT s.teamID, s.playerID, lt.teamID, lt.franchID, tf.franchID, tf.franchName, hf.playerID, hf.inducted
FROM lahman.Salaries
JOIN lahman.Teams lt ON s.teamID = lt.teamID
JOIN lahman.TeamsFranchises tf ON  lt.franchID = tf.franchID
JOIN lahman.HallOfFame hf ON s.playerID = hf.playerID
WHERE hf.inducted = 'Y'
AND s.yearID >= 2016;")

```

```{r}
bball <- dbConnect_scidb(dbname = "lahman")

bball_df <- bball %>%
  dbGetQuery("SELECT DISTINCT s.teamID, s.playerID, lt.teamID, lt.franchID, tf.franchID, tf.franchName, hf.playerID, hf.inducted, s.salary, s.yearid
FROM lahman.Salaries s
JOIN lahman.Teams lt ON s.teamID = lt.teamID
JOIN lahman.TeamsFranchises tf ON  lt.franchID = tf.franchID
JOIN lahman.HallOfFame hf ON s.playerID = hf.playerID
;
")
```



Julia 